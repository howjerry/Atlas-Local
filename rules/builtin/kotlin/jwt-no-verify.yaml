id: atlas/security/kotlin/jwt-no-verify
name: JWT Token Parsed Without Signature Verification
description: >
  Detects usage of JWT parsing methods that skip signature verification,
  such as JJWT's parseClaimsJwt() or parsePlaintextJwt(). These methods
  parse the JWT without verifying the signature, allowing attackers to
  forge tokens with arbitrary claims and bypass authentication.
severity: critical
category: security
language: Kotlin
cwe_id: CWE-345
pattern: |
  [
    (call_expression
      (navigation_expression
        (_) @obj
        (identifier) @method)
      (value_arguments)
      (#match? @method "^(parseClaimsJwt|parsePlaintextJwt)$"))
    @match

    (call_expression
      (navigation_expression
        (_) @obj
        (identifier) @method)
      (value_arguments)
      (#eq? @method "decode"))
    @match
  ]
remediation: >
  Always verify JWT signatures. Use parseClaimsJws() instead of
  parseClaimsJwt() and provide a signing key:
  `Jwts.parser().setSigningKey(key).parseClaimsJws(token)`. For Auth0
  java-jwt, use JWT.require(algorithm).build().verify(token).
references:
  - https://cwe.mitre.org/data/definitions/345.html
  - https://github.com/jwtk/jjwt
tags:
  - jwt
  - authentication
  - owasp-top-10
  - a02-cryptographic-failures
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A02:2021"
      description: Cryptographic Failures
version: 1.0.0


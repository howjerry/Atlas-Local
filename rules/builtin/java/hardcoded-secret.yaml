id: atlas/security/java/hardcoded-secret
name: Hardcoded Secret in Source Code
description: >
  Detects hardcoded passwords, API keys, secrets, and tokens assigned as
  string literals in variable declarations. Hardcoded secrets in source code
  can be extracted by anyone with access to the code or compiled bytecode,
  leading to unauthorized access to systems and data.
severity: high
category: security
language: Java
cwe_id: CWE-798
pattern: |
  (variable_declarator
    name: (identifier) @var_name
    value: (string_literal) @secret_value
    (#match? @var_name "(?i)(password|passwd|secret|api_key|apikey|api_secret|token|auth_token|access_key|private_key)"))
  @match
remediation: >
  Never hardcode secrets in source code. Use environment variables,
  configuration files excluded from version control, or a dedicated
  secrets management solution such as HashiCorp Vault, AWS Secrets
  Manager, or Azure Key Vault. For example, replace
  `String password = "secret123"` with
  `String password = System.getenv("DB_PASSWORD")`.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html
  - https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password
tags:
  - hardcoded-secret
  - credentials
  - owasp-top-10
  - a07-identification-and-authentication-failures
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: IA-5
      description: Authenticator Management
version: 1.0.0

id: atlas/security/python/hardcoded-secret
name: Hardcoded Secret in Source Code
description: >
  Detects hardcoded passwords, API keys, and secrets assigned as string literals
  in source code. Hardcoded credentials are a significant security risk because
  they can be extracted from source code, version control history, or compiled
  binaries. Once discovered, an attacker gains direct access to the associated
  service or system.
severity: high
category: security
language: Python
cwe_id: CWE-798
pattern: |
  (assignment
    left: (identifier) @var_name
    (#match? @var_name "(?i)(password|passwd|secret|api_key|apikey|token|auth_token|access_key|private_key)")
    right: (string) @value)
  @match
remediation: >
  Never hardcode secrets in source code. Use environment variables via
  `os.environ.get("SECRET_KEY")`, a secrets management service (AWS Secrets
  Manager, HashiCorp Vault), or a `.env` file (excluded from version control)
  loaded via `python-dotenv`. Rotate any secrets that were previously committed
  to version control.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html
  - https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password
tags:
  - hardcoded-secret
  - credentials
  - owasp-top-10
  - a07-identification-failures
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: IA-5
      description: Authenticator Management
version: 1.0.0

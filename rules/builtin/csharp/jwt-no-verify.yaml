id: atlas/security/csharp/jwt-no-verify
name: JWT Token Parsed Without Signature Verification
description: >
  Detects JWT token parsing where signature validation is disabled by
  setting ValidateIssuerSigningKey, ValidateLifetime, or ValidateAudience
  to false in TokenValidationParameters. Without signature verification,
  an attacker can forge JWT tokens with arbitrary claims to bypass
  authentication and authorization.
severity: critical
category: security
language: CSharp
cwe_id: CWE-345
pattern: |
  [
    (assignment_expression
      left: (member_access_expression
        name: (identifier) @prop
        (#eq? @prop "ValidateIssuerSigningKey"))
      right: (boolean_literal) @value
      (#eq? @value "false"))
    @match

    (assignment_expression
      left: (member_access_expression
        name: (identifier) @prop
        (#eq? @prop "RequireSignedTokens"))
      right: (boolean_literal) @value
      (#eq? @value "false"))
    @match
  ]
remediation: >
  Always set ValidateIssuerSigningKey = true and RequireSignedTokens = true
  in TokenValidationParameters. Provide a valid IssuerSigningKey. Example:
  `new TokenValidationParameters { ValidateIssuerSigningKey = true,
  IssuerSigningKey = new SymmetricSecurityKey(key) }`
references:
  - https://cwe.mitre.org/data/definitions/345.html
  - https://learn.microsoft.com/en-us/dotnet/api/microsoft.identitymodel.tokens.tokenvalidationparameters
tags:
  - jwt
  - authentication
  - owasp-top-10
  - a02-cryptographic-failures
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A02:2021"
      description: Cryptographic Failures
version: 1.0.0


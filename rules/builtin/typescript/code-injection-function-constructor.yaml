id: atlas/security/typescript/code-injection-function-constructor
name: Code Injection via Function Constructor
description: >
  Detects usage of the Function constructor (new Function()) which
  dynamically creates and executes JavaScript code from strings at
  runtime. Like eval(), if user-controlled data is passed to the
  Function constructor, an attacker can execute arbitrary code in the
  application context, leading to remote code execution and complete
  system compromise.
severity: critical
category: security
language: TypeScript
cwe_id: CWE-94
pattern: |
  (new_expression
    constructor: (identifier) @ctor
    (#eq? @ctor "Function"))
  @match
remediation: >
  Avoid using the Function constructor to create functions from strings.
  Define functions statically in your source code. If dynamic behavior
  is needed, use a configuration-driven approach with predefined functions
  selected at runtime, or use a safe sandboxed interpreter. For dynamic
  property access, use bracket notation (obj[key]) or Map/Object lookups.
references:
  - https://cwe.mitre.org/data/definitions/94.html
  - https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/Function
  - https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html
tags:
  - code-injection
  - function-constructor
  - injection
  - owasp-top-10
  - a03-injection
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A03:2021"
      description: Injection
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: SI-10
      description: Information Input Validation
version: 1.0.0

id: atlas/security/typescript/prototype-pollution
name: Prototype Pollution via Object.assign
description: >
  Detects usage of Object.assign() which can lead to prototype pollution
  when merging user-controlled objects. An attacker can inject properties
  like __proto__ or constructor.prototype to modify the behavior of all
  objects in the application, potentially leading to denial of service,
  authentication bypass, or remote code execution.
severity: high
category: security
language: TypeScript
cwe_id: CWE-1321
pattern: |
  (call_expression
    function: (member_expression
      object: (identifier) @_obj
      property: (property_identifier) @_method
      (#eq? @_obj "Object")
      (#eq? @_method "assign")))
  @match
remediation: >
  Avoid using Object.assign() with untrusted input. Use structured cloning,
  a schema validation library (e.g., zod, joi), or a safe merge utility that
  filters out __proto__ and constructor properties. For simple merging, use
  object spread syntax with known properties only:
  `const merged = { ...defaults, name: input.name, age: input.age };`
references:
  - https://cwe.mitre.org/data/definitions/1321.html
  - https://cheatsheetseries.owasp.org/cheatsheets/Prototype_Pollution_Prevention_Cheat_Sheet.html
  - https://portswigger.net/web-security/prototype-pollution
tags:
  - prototype-pollution
  - injection
  - owasp-top-10
  - a03-injection
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A03:2021"
      description: Injection
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: SI-10
      description: Information Input Validation
version: 1.0.0

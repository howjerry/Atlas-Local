id: atlas/security/typescript/hardcoded-secret
name: Hardcoded Secret in Source Code
description: >
  Detects string literals assigned to variables whose names suggest they
  contain secrets (password, secret, api_key, apikey, auth_token). Hardcoded
  secrets in source code can be extracted by anyone with access to the
  codebase, version control history, or compiled artifacts, leading to
  unauthorized access to external services and data breaches.
severity: high
category: security
language: TypeScript
cwe_id: CWE-798
pattern: |
  (variable_declarator
    name: (identifier) @_name
    value: (string)
    (#match? @_name "(?i)(password|secret|api_key|apikey|auth_token|api_secret|secret_key|private_key)"))
  @match
remediation: >
  Never hardcode secrets in source code. Use environment variables
  (process.env.SECRET_KEY), a secrets manager (AWS Secrets Manager,
  HashiCorp Vault), or a .env file excluded from version control. For
  example, replace `const apiKey = "abc123"` with
  `const apiKey = process.env.API_KEY`.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html
  - https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password
tags:
  - hardcoded-secret
  - credentials
  - owasp-top-10
  - a07-identification-failures
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: IA-5
      description: Authenticator Management
version: 1.0.0

id: atlas/secrets/generic/google-api-key
name: Hardcoded Google API Key
description: >
  Detects hardcoded Google API keys (starting with AIza) in string
  literals. Google API keys can be used to access Google Cloud services,
  consume API quotas, and potentially access sensitive data depending
  on the key's configured permissions.
severity: high
category: secrets
language: TypeScript
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: IA-5
      description: Authenticator Management
    - framework: hipaa-security
      requirement: "164.312(d)"
      description: Person or Entity Authentication
skip_test_files: true
pattern: |
  (string
    (string_fragment) @value
    (#match? @value "^AIza[A-Za-z0-9_-]{30,}"))
  @match
remediation: >
  Remove the hardcoded Google API key from source code. Use environment
  variables, Google Cloud Secret Manager, or application default
  credentials to provide API keys at runtime. Restrict the exposed key
  via the Google Cloud Console (API restrictions, application restrictions).
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://cloud.google.com/docs/authentication/api-keys
tags:
  - secrets
  - google
  - gcp
  - hardcoded-credentials
  - api-key
version: 1.0.0

id: atlas/secrets/generic/github-token
name: Hardcoded GitHub Token
description: >
  Detects hardcoded GitHub personal access tokens (ghp_), OAuth tokens
  (gho_), server-to-server tokens (ghs_), and user-to-server tokens
  (ghu_) in string literals. Exposed GitHub tokens can be used to access
  repositories, modify code, create releases, and perform actions on
  behalf of the token owner.
severity: critical
category: secrets
language: TypeScript
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: IA-5
      description: Authenticator Management
    - framework: hipaa-security
      requirement: "164.312(d)"
      description: Person or Entity Authentication
skip_test_files: true
pattern: |
  (string
    (string_fragment) @value
    (#match? @value "^(ghp_|gho_|ghs_|ghu_|github_pat_)[A-Za-z0-9_]{20,}"))
  @match
remediation: >
  Remove the hardcoded GitHub token from source code. Use environment
  variables (GITHUB_TOKEN), GitHub Actions secrets, or a secrets manager
  to provide tokens at runtime. Revoke the exposed token immediately
  via GitHub Settings > Developer settings > Personal access tokens.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens
tags:
  - secrets
  - github
  - hardcoded-credentials
  - owasp-top-10
version: 1.0.0

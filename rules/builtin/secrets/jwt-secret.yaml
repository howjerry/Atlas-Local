id: atlas/secrets/generic/jwt-secret
name: Hardcoded JWT Signing Secret
description: >
  Detects hardcoded JWT signing secrets assigned to variables with names
  containing "jwt" or "token" paired with "secret" or "key". Exposed JWT
  signing secrets allow attackers to forge authentication tokens.
severity: high
category: secrets
language: TypeScript
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
skip_test_files: true
pattern: |
  ((variable_declarator
    name: (identifier) @name
    value: (string) @match)
   (#match? @name "(?i)(jwt|token)[_-]?(secret|key)"))
remediation: >
  Remove the hardcoded JWT secret from source code. Use environment
  variables (JWT_SECRET) or a secrets manager to provide signing keys
  at runtime. Rotate the exposed secret and invalidate all existing tokens.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://jwt.io/introduction
tags:
  - secrets
  - jwt
  - hardcoded-credentials
  - authentication
  - owasp-top-10
version: 1.0.0

id: atlas/secrets/generic/npm-token
name: Hardcoded NPM Access Token
description: >
  Detects hardcoded NPM access tokens (starting with npm_) in string
  literals. Exposed NPM tokens can be used to publish malicious packages,
  modify existing packages, or access private packages.
severity: high
category: secrets
language: TypeScript
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
pattern: |
  (string
    (string_fragment) @value
    (#match? @value "^npm_[A-Za-z0-9]{36,}"))
  @match
remediation: >
  Remove the hardcoded NPM token from source code. Use environment
  variables (NPM_TOKEN) or .npmrc with environment variable interpolation.
  Revoke the exposed token via npm.js account settings.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://docs.npmjs.com/about-access-tokens
tags:
  - secrets
  - npm
  - hardcoded-credentials
  - supply-chain
  - owasp-top-10
version: 1.0.0

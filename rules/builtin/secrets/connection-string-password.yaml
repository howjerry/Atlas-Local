id: atlas/secrets/generic/connection-string-password
name: Hardcoded Connection String with Password
description: >
  Detects connection strings that contain embedded passwords in string
  literals. Connection strings with patterns like "://user:password@host"
  or "password=..." expose database or service credentials. These can
  be used to gain unauthorized access to backend systems.
severity: critical
category: secrets
language: TypeScript
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: IA-5
      description: Authenticator Management
    - framework: hipaa-security
      requirement: "164.312(d)"
      description: Person or Entity Authentication
pattern: |
  (string
    (string_fragment) @value
    (#match? @value "://[^:]+:[^@]{4,}@"))
  @match
remediation: >
  Remove embedded passwords from connection strings. Use environment
  variables for connection strings (e.g., DATABASE_URL), a secrets
  manager, or separate configuration for credentials. Consider using
  IAM-based authentication (e.g., AWS RDS IAM auth) where possible.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://cheatsheetseries.owasp.org/cheatsheets/Database_Security_Cheat_Sheet.html
tags:
  - secrets
  - connection-string
  - database
  - hardcoded-credentials
  - owasp-top-10
version: 1.0.0

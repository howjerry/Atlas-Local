id: atlas/secrets/generic/private-key-header
name: Private Key in Source Code
description: >
  Detects PEM-encoded private key headers (RSA, EC, DSA, OpenSSH) in
  string literals. Private keys embedded in source code can be extracted
  and used to decrypt data, impersonate servers, or sign malicious content.
severity: critical
category: secrets
language: TypeScript
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
skip_test_files: true
pattern: |
  (string
    (string_fragment) @value
    (#match? @value "-----BEGIN (RSA |EC |DSA |OPENSSH )?PRIVATE KEY-----"))
  @match
remediation: >
  Remove the private key from source code immediately. Store private keys
  in a secrets manager (AWS Secrets Manager, HashiCorp Vault) or use
  file-based secrets mounted at runtime. Generate a new key pair and
  revoke any certificates associated with the exposed key.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password
tags:
  - secrets
  - private-key
  - hardcoded-credentials
  - cryptography
  - owasp-top-10
version: 1.0.0

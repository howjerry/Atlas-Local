id: atlas/secrets/generic/azure-storage-key
name: Hardcoded Azure Storage Account Key
description: >
  Detects hardcoded Azure Storage account keys in connection strings.
  Azure Storage keys grant full access to the storage account, including
  reading, writing, and deleting blobs, tables, queues, and files.
severity: high
category: secrets
language: TypeScript
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
skip_test_files: true
pattern: |
  (string
    (string_fragment) @value
    (#match? @value "AccountKey=[A-Za-z0-9+/=]{80,}"))
  @match
remediation: >
  Remove the hardcoded Azure Storage key from source code. Use Azure
  Managed Identity, environment variables, or Azure Key Vault to provide
  credentials at runtime. Rotate the exposed key via the Azure Portal.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://learn.microsoft.com/en-us/azure/storage/common/storage-account-keys-manage
tags:
  - secrets
  - azure
  - hardcoded-credentials
  - owasp-top-10
version: 1.0.0

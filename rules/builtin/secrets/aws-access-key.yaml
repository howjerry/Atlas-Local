id: atlas/secrets/generic/aws-access-key
name: Hardcoded AWS Access Key
description: >
  Detects hardcoded AWS access key IDs (starting with AKIA or ASIA) in
  string literals. AWS access keys should never be committed to source
  code. An exposed key pair can grant full access to the associated
  AWS account, enabling data theft, resource abuse, and privilege
  escalation.
severity: critical
category: secrets
language: TypeScript
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: IA-5
      description: Authenticator Management
    - framework: hipaa-security
      requirement: "164.312(d)"
      description: Person or Entity Authentication
skip_test_files: true
pattern: |
  (string
    (string_fragment) @value
    (#match? @value "^(AKIA|ASIA)[A-Z0-9]{12,}"))
  @match
remediation: >
  Remove the hardcoded AWS access key from source code. Use environment
  variables (AWS_ACCESS_KEY_ID), AWS IAM instance profiles, or a secrets
  manager (AWS Secrets Manager, HashiCorp Vault) to provide credentials
  at runtime. Rotate the exposed key immediately via the AWS IAM console.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html
  - https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password
tags:
  - secrets
  - aws
  - hardcoded-credentials
  - owasp-top-10
  - a07-identification-and-authentication-failures
version: 1.0.0

id: atlas/secrets/generic/stripe-secret-key
name: Hardcoded Stripe Secret Key
description: >
  Detects hardcoded Stripe secret API keys (sk_live_ or sk_test_) in
  string literals. Exposed Stripe secret keys can be used to create
  charges, refunds, and access customer payment data.
severity: critical
category: secrets
language: TypeScript
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
pattern: |
  (string
    (string_fragment) @value
    (#match? @value "^(sk_live|sk_test)_[A-Za-z0-9]{20,}"))
  @match
remediation: >
  Remove the hardcoded Stripe secret key from source code. Use environment
  variables (STRIPE_SECRET_KEY) or a secrets manager. Roll the exposed
  key in your Stripe Dashboard immediately.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://docs.stripe.com/keys
tags:
  - secrets
  - stripe
  - hardcoded-credentials
  - payment
  - owasp-top-10
version: 1.0.0

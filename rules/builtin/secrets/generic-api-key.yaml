id: atlas/secrets/generic/generic-api-key
name: Hardcoded API Key Assignment
description: >
  Detects assignment of string values to variables with names suggesting
  they contain API keys, secrets, passwords, or tokens. Variable names
  matching patterns like api_key, secret, password, token, credential,
  or auth combined with a string literal value indicate hardcoded secrets.
severity: high
category: secrets
language: TypeScript
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: IA-5
      description: Authenticator Management
    - framework: hipaa-security
      requirement: "164.312(d)"
      description: Person or Entity Authentication
pattern: |
  (variable_declarator
    name: (identifier) @var_name
    value: (string
      (string_fragment) @value)
    (#match? @var_name "(?i)(api[_-]?key|secret|password|passwd|token|credential|auth[_-]?key|private[_-]?key|access[_-]?key|signing[_-]?key|encryption[_-]?key)"))
  @match
remediation: >
  Remove the hardcoded secret value from source code. Use environment
  variables, a configuration file excluded from version control, or a
  secrets manager (HashiCorp Vault, AWS Secrets Manager, Azure Key Vault)
  to provide sensitive values at runtime.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password
tags:
  - secrets
  - hardcoded-credentials
  - api-key
  - owasp-top-10
  - a07-identification-and-authentication-failures
version: 1.0.0

id: atlas/secrets/generic/gitlab-pat
name: Hardcoded GitLab Personal Access Token
description: >
  Detects hardcoded GitLab personal access tokens (starting with glpat-)
  in string literals. Exposed GitLab tokens can be used to access
  repositories, pipelines, and perform API actions on behalf of the owner.
severity: high
category: secrets
language: TypeScript
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
skip_test_files: true
pattern: |
  (string
    (string_fragment) @value
    (#match? @value "^glpat-[A-Za-z0-9_-]{20,}"))
  @match
remediation: >
  Remove the hardcoded GitLab token from source code. Use environment
  variables (GITLAB_TOKEN) or a secrets manager. Revoke the exposed
  token via GitLab Settings > Access Tokens.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html
tags:
  - secrets
  - gitlab
  - hardcoded-credentials
  - owasp-top-10
version: 1.0.0

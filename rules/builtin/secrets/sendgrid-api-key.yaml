id: atlas/secrets/generic/sendgrid-api-key
name: Hardcoded SendGrid API Key
description: >
  Detects hardcoded SendGrid API keys (starting with SG.) in string
  literals. Exposed SendGrid keys can be used to send emails on behalf
  of the account, potentially enabling phishing or spam campaigns.
severity: high
category: secrets
language: TypeScript
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
skip_test_files: true
pattern: |
  (string
    (string_fragment) @value
    (#match? @value "^SG\\.[A-Za-z0-9_-]{20,}\\.[A-Za-z0-9_-]{40,}"))
  @match
remediation: >
  Remove the hardcoded SendGrid API key from source code. Use environment
  variables (SENDGRID_API_KEY) or a secrets manager. Delete and recreate
  the exposed key in the SendGrid dashboard.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://docs.sendgrid.com/ui/account-and-settings/api-keys
tags:
  - secrets
  - sendgrid
  - hardcoded-credentials
  - email
  - owasp-top-10
version: 1.0.0

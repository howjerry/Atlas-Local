id: atlas/secrets/generic/jwt-token
name: Hardcoded JWT Token
description: >
  Detects hardcoded JSON Web Tokens (JWT) in string literals. JWTs
  starting with "eyJ" (base64-encoded JSON header) are likely authentication
  or authorization tokens. Hardcoded JWTs can be used to impersonate
  users or bypass authentication mechanisms.
severity: high
category: secrets
language: TypeScript
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: IA-5
      description: Authenticator Management
    - framework: hipaa-security
      requirement: "164.312(d)"
      description: Person or Entity Authentication
skip_test_files: true
pattern: |
  (string
    (string_fragment) @value
    (#match? @value "^eyJ[A-Za-z0-9_-]{20,}\\.eyJ[A-Za-z0-9_-]{20,}"))
  @match
remediation: >
  Remove the hardcoded JWT from source code. JWTs should be generated
  dynamically at runtime and stored in secure, short-lived session
  storage. Use environment variables or a secrets manager for any
  signing keys used to create JWTs.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://jwt.io/introduction
tags:
  - secrets
  - jwt
  - hardcoded-credentials
  - authentication
version: 1.0.0

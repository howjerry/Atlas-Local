id: atlas/security/ruby/hardcoded-secret
name: Hardcoded Secret in Source Code
description: >
  Detects hardcoded secrets, passwords, API keys, or tokens assigned as
  string literals in Ruby source code. Hardcoded credentials pose a serious
  security risk as they can be extracted from source code repositories and
  used to gain unauthorized access to systems and services.
severity: high
category: security
language: Ruby
cwe_id: CWE-798
pattern: |
  ((assignment
    left: (identifier) @var_name
    (#match? @var_name "(?i)(password|passwd|secret|api_key|apikey|token|auth_token|private_key|secret_key|access_key)")
    right: (string)) @match)
remediation: >
  Never hardcode secrets in source code. Use environment variables via
  `ENV['SECRET_KEY']`, Rails credentials via `Rails.application.credentials`,
  or a secrets management service such as HashiCorp Vault or AWS Secrets
  Manager. For development, use the `dotenv` gem with a `.env` file that
  is excluded from version control via `.gitignore`.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html
  - https://guides.rubyonrails.org/security.html#environmental-security
tags:
  - hardcoded-secret
  - credentials
  - owasp-top-10
  - a07-identification-authentication
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: IA-5
      description: Authenticator Management
version: 1.0.0

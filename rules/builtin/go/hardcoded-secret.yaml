id: atlas/security/go/hardcoded-secret
name: Hardcoded Secret in Variable Declaration
description: >
  Detects hardcoded passwords, secrets, API keys, and tokens assigned
  directly as string literals in variable declarations. Hardcoded
  credentials in source code can be extracted by anyone with access
  to the repository and cannot be rotated without redeployment.
severity: high
category: security
language: Go
cwe_id: CWE-798
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A07:2021"
      description: Identification and Authentication Failures
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: IA-5
      description: Authenticator Management
pattern: |
  [
    (short_var_declaration
      left: (expression_list
        (identifier) @name
        (#match? @name "(?i)(password|passwd|secret|api_key|apikey|api_secret|token|auth_token|access_key|private_key)"))
      right: (expression_list
        (interpreted_string_literal) @value))
    @match

    (var_declaration
      (var_spec
        name: (identifier) @name
        (#match? @name "(?i)(password|passwd|secret|api_key|apikey|api_secret|token|auth_token|access_key|private_key)")
        value: (expression_list
          (interpreted_string_literal) @value)))
    @match
  ]
remediation: >
  Store secrets in environment variables, a secrets manager (e.g., HashiCorp
  Vault, AWS Secrets Manager), or encrypted configuration files. Use
  os.Getenv to read secrets at runtime. Never commit credentials to source
  control. Consider using tools like git-secrets or pre-commit hooks to
  prevent accidental secret commits.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html
  - https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/
tags:
  - hardcoded-secret
  - credentials
  - owasp-top-10
  - a07-identification-authentication
version: 1.0.0

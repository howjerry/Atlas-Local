id: atlas/security/php/xss
name: Cross-Site Scripting via Unescaped Output
description: >
  Detects potential cross-site scripting (XSS) vulnerabilities where
  variables are directly output using echo or print without proper
  escaping. An attacker can inject malicious scripts that execute in
  the context of other users' browsers, leading to session hijacking,
  data theft, or defacement.
severity: high
category: security
language: Php
cwe_id: CWE-79
pattern: |
  [
    (echo_statement
      (encapsed_string) @output)
    @match

    (echo_statement
      (variable_name) @output)
    @match

    (print_intrinsic
      (encapsed_string) @output)
    @match

    (print_intrinsic
      (variable_name) @output)
    @match
  ]
remediation: >
  Always escape output using htmlspecialchars() or htmlentities() before
  rendering user-controlled data in HTML. For example, use
  `echo htmlspecialchars($userInput, ENT_QUOTES, 'UTF-8');` instead of
  `echo $userInput;`. Consider using a templating engine with automatic
  escaping such as Twig or Blade.
references:
  - https://cwe.mitre.org/data/definitions/79.html
  - https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html
  - https://www.php.net/manual/en/function.htmlspecialchars.php
tags:
  - xss
  - injection
  - owasp-top-10
  - a03-injection
metadata:
  compliance:
    - framework: owasp-top-10-2021
      requirement: "A03:2021"
      description: Injection
    - framework: pci-dss-4.0
      requirement: "6.2.4"
      description: Prevention of Common Software Attacks
    - framework: nist-800-53
      requirement: SI-10
      description: Information Input Validation
version: 1.0.0
